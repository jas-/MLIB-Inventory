$(document).ready(function(){($(".ui-page-active").attr("id")=="main")?g("current","http://inventory.dev:8080/?do=current",{"do":true},true,"inventory-current"):false;($(".ui-page-active").attr("id")=="search")?g("search",false,false,true,"search-computer"):false;$("#main").live("pagecreate pageshow",function(o,p){k("current");g("current","http://inventory.dev:8080/?do=current",{"do":true},true,"inventory-current")});$("#search").live("pagecreate pageshow",function(o){k("search");g("search",false,false,true,"search-computer")});$("#add-computer").comm({appID:"MLIB-Inventory",callback:function(){l($(this),"add-computer")}});$("#add-monitor").comm({appID:"MLIB-Inventory",callback:function(){l($(this),"add-monitor")}});$("#edit-computer").comm({appID:"MLIB-Inventory",callback:function(){l($(this),"edit-computer")}});$("#edit-monitor").comm({appID:"MLIB-Inventory",callback:function(){l($(this),"edit-monitor")}});function k(o){$("#jqxgrid-"+o).jqxGrid("destroy");$("#jqxWidget-"+o).html('<div id="jqxgrid-'+o+'"></div>')}function g(s,p,r,q,o){$("#"+o).comm({appID:"MLIB-Inventory",url:(p)?p:false,data:(r)?r:false,callback:function(){l($(this),s);k(s);(q)?d($(this),s):false;l($(this),s)}})}function d(v,s){var u=getDemoTheme();var p=function(x,y){var w=new Array();if(y=="ascending"){y=true}if(y=="descending"){y=false}if(y!=null){for(i=0;i<v.length;i++){w.push(v[i])}}else{w=v}var z=Object.prototype.toString;Object.prototype.toString=(typeof x=="function")?x:function(){return this[x]};if(y!=null){w.sort(r);if(!y){w.reverse()}}q.localdata=w;$("#jqxgrid-"+s).jqxGrid("databind",q,"sort");$("#jqxgrid").jqxGrid("savestate");Object.prototype.toString=z};var r=function(y,x){y=String(y).toLowerCase();x=String(x).toLowerCase();try{var w=parseFloat(y);if(isNaN(w)){if(y<x){return -1}if(y>x){return 1}}else{var B=parseFloat(x);if(w<B){return -1}if(w>B){return 1}}}catch(z){var A=z}return 0};var q={localdata:v,sort:p,datafields:[{name:"Computer",type:"string"},{name:"SKU",type:"string"},{name:"Serial",type:"string"},{name:"UUIC",type:"string"},{name:"MSerial",map:"Monitor>0>Serial",type:"string"},{name:"MSKU",map:"Monitor>0>SKU",type:"string"}],datatype:"json"};var t=new $.jqx.dataAdapter(q);if(e()){var o=function(){var z=$("<div style='margin-top: 5px; width: 100%; height: 100%;'></div>");var A=$("#jqxgrid-"+s).jqxGrid("getdatainformation");var B=A.paginginformation;var w=$("<div style='padding: 1px; float: left;'><div style='margin-left: 9px; width: 16px; height: 16px;'></div></div>");w.find("div").addClass("icon-arrow-left");w.width(36);w.jqxButton();var y=$("<div style='padding: 1px; margin: 0px 3px; float: left;'><div style='margin-left: 9px; width: 16px; height: 16px;'></div></div>");y.find("div").addClass("icon-arrow-right");y.width(36);y.jqxButton();w.appendTo(z);y.appendTo(z);var x=$("<div style='font-size: 11px; margin: 2px 3px; font-weight: bold; float: left;'></div>");x.text("1-"+B.pagesize+" of "+A.rowscount);x.appendTo(z);y.click(function(){$("#jqxgrid").jqxGrid("gotonextpage");var C=$("#jqxgrid-"+s).jqxGrid("getdatainformation");var D=C.paginginformation;x.text(1+D.pagenum*D.pagesize+"-"+Math.min(C.rowscount,(D.pagenum+1)*D.pagesize)+" of "+C.rowscount)});w.click(function(){$("#jqxgrid-"+s).jqxGrid("gotoprevpage");var C=$("#jqxgrid").jqxGrid("getdatainformation");var D=C.paginginformation;x.text(1+D.pagenum*D.pagesize+"-"+Math.min(C.rowscount,(D.pagenum+1)*D.pagesize)+" of "+C.rowscount)});return z}}else{var o=false}$("#jqxgrid-"+s).jqxGrid({autoshowloadelement:true,width:"100%",altrows:true,pagerrenderer:o,pagesize:(e())?5:20,pagesizeoptions:["5","10","20","30","40","50"],source:t,theme:u,sortable:true,pageable:true,scrollmode:"logical",autoheight:true,autosave:true,autorestore:true,selectionmode:"singlerow",ready:function(){$("#jqxgrid").jqxGrid("loadstate",$("#jqxgrid").jqxGrid("getstate"));$("#jqxgrid-"+s).jqxGrid("sortby","Hostname","asc")},columns:[{text:"Hostname",datafield:"Computer",width:"20%"},{text:"SKU",datafield:"SKU",width:"20%"},{text:"Serial",datafield:"Serial",width:"20%"},{text:"UUIC",datafield:"UUIC",width:"10%"},{text:"Monitor Serial",datafield:"MSerial",width:"20%"},{text:"Monitor SKU",datafield:"MSKU",width:"10%"}]});$("#jqxgrid-"+s).on({rowclick:function(w){$("#record-details").simpledialog2({headerText:"Edit inventory record",dialogAllow:true,dialogForce:true,safeNuke:true,blankContentAdopt:true,callbackOpen:function(){$("#message-edit-computer").html("");$("#message-edit-monitor").html("")}});var x=v[$("#jqxgrid-"+s).jqxGrid("getrowid",args.rowindex)];h("edit-computer");h("edit-monitor");f("edit-computer",x);f("edit-monitor",x);c("edit-computer",x);c("edit-monitor",x)}})}function l(q,p){if(q!=""){var o="";if(q[0]["details"]){o=m(q[0]["details"])}$.each(q,function(r,s){$.each(s,function(u,t){if(u=="error"){$("#message-"+p).html('<div class="error">'+t+o+"</div>").fadeIn(2000).delay(3500).fadeOut("slow")}if(u=="warning"){$("#message-"+p).html('<div class="warning">'+t+o+"</div>").fadeIn(2000).delay(3500).fadeOut("slow")}if(u=="info"){$("#message-"+p).html('<div class="info">'+t+o+"</div>").fadeIn(2000).delay(3500).fadeOut("slow")}if(u=="success"){$("#message-"+p).html('<div class="success">'+t+o+"</div>").fadeIn(2000).delay(3500).fadeOut("slow")}})})}else{$("#message-"+p).html('<div class="warning">Empty response for request</div>').fadeIn(2000).delay(3500).fadeOut("slow")}}function m(p){var o="<hr/><div>Details:<ul>";$.each(p,function(r,q){o+="<li><i>"+r+"</i>: "+q+"</li>"});o+="</ul></div>";return o}function f(o,p){if(j(p)>0){$("#"+o+" #hostname").val(p.Computer);$("#"+o+" #sku").val(p.SKU);$("#"+o+" #uuic").val(p.UUIC);$("#"+o+" #serial").val(p.Serial);$("#"+o+" #model").val(p.Model);$("#"+o+" #location").val(p.Location);$("#"+o+" #eowd").val(p.EOWD);$("#"+o+" #opd").val(p.OPD);$("#"+o+" #notes").val(p.Notes);if(j(p.Monitor)>0){$("#"+o+" #monitor").val(p.Monitor[0].Monitor);$("#"+o+" #mmodel").val(p.Monitor[0].MModel);$("#"+o+" #msku").val(p.Monitor[0].SKU);$("#"+o+" #mserial").val(p.Monitor[0].Serial);$("#"+o+" #meowd").val(p.Monitor[0].MEOWD);$("#"+o+" #mlocation").val(p.Monitor[0].MLocation)}else{$("#"+o+" #monitor").val(p.Monitor);$("#"+o+" #mmodel").val(p.MModel);$("#"+o+" #msku").val(p.MSKU);$("#"+o+" #mserial").val(p.MSerial);$("#"+o+" #meowd").val(p.MEOWD);$("#"+o+" #mlocation").val(p.MLocation)}}}function h(o,p){if($("#"+o+" #"+p).is("form")){$.each($("#"+o+" #"+p),function(q,r){$.each(r,function(t,s){$(t).val("")})})}}function c(o,p){(p.SKU)?$("#"+o+" #sku").textinput("disable"):$("#"+o+" #sku").textinput("enable");(p.UUIC)?$("#"+o+" #uuic").textinput("disable"):$("#"+o+" #uuic").textinput("enable");(p.Serial)?$("#"+o+" #serial").textinput("disable"):$("#"+o+" #serial").textinput("enable");(p.EOWD)?$("#"+o+" #eowd").textinput("disable"):$("#"+o+" #eowd").textinput("enable");(p.OPD)?$("#"+o+" #opd").textinput("disable"):$("#"+o+" #opd").textinput("enable");if(j(p.Monitor)>0){(p.Monitor[0].SKU)?$("#"+o+" #msku").textinput("disable"):$("#"+o+" #msku").textinput("enable");(p.Monitor[0].Serial)?$("#"+o+" #mserial").textinput("disable"):$("#"+o+" #mserial").textinput("enable");(p.Monitor[0].EOWD)?$("#"+o+" #meowd").textinput("disable"):$("#"+o+" #meowd").textinput("enable")}else{(p.MSKU)?$("#"+o+" #msku").textinput("disable"):$("#"+o+" #msku").textinput("enable");(p.MSerial)?$("#"+o+" #mserial").textinput("disable"):$("#"+o+" #mserial").textinput("enable");(p.MEOWD)?$("#"+o+" #meowd").textinput("disable"):$("#"+o+" #meowd").textinput("enable")}}function a(o){$.each(o,function(p,q){if((/object|array/.test(typeof(q)))&&(j(q)>0)){console.log("inspect: Examining "+p+" ("+typeof(q)+")");a(q)}else{console.log("inspect: "+p+" => "+q)}})}function j(o){var p=0;if(/object/.test(typeof(o))){$.each(o,function(r,q){if(o.hasOwnProperty(r)){p++}})}else{if(/array/.test(typeof(o))){p=o.length}}return p}function b(p){if(j(p)>0){var o="";$.each(p,function(r,q){if(typeof(q)==="object"){$.each(q,function(t,s){o+=r+"["+t+"]="+s+"&"})}else{o+=r+"="+q+"&"}});o=o.substring(0,o.length-1)}else{return false}return o}function e(){return/android|blackberry|symbian|iemobile|ipad|iphone/gi.test(navigator.userAgent)}function n(){var o=new Date();return o.toISOString()}});